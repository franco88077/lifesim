{% extends "layouts/base.html" %}

{% block extra_css %}
  <link rel="stylesheet" href="{{ url_for('banking.static', filename='styles/banking.css') }}" />
{% endblock %}

{% block extra_js %}
  <script src="{{ url_for('banking.static', filename='js/banking_home.js') }}" defer></script>
{% endblock %}

{% block content %}
  <div class="banking-shell">
    <section class="banking-subnav" aria-label="Banking navigation">
      <nav class="banking-tabs">
        <a
          href="{{ url_for('banking.home') }}"
          class="banking-tab{% if active_banking_tab == 'home' %} is-active{% endif %}"
          {% if active_banking_tab == 'home' %}aria-current="page"{% endif %}
        >
          Banking Home
        </a>
        <a
          href="{{ url_for('banking.insights') }}"
          class="banking-tab{% if active_banking_tab == 'insights' %} is-active{% endif %}"
          {% if active_banking_tab == 'insights' %}aria-current="page"{% endif %}
        >
          Account Insights
        </a>
        <a
          href="{{ url_for('banking.transfer') }}"
          class="banking-tab{% if active_banking_tab == 'transfer' %} is-active{% endif %}"
          {% if active_banking_tab == 'transfer' %}aria-current="page"{% endif %}
        >
          Banking Transfer
        </a>
        <a
          href="{{ url_for('banking.settings') }}"
          class="banking-tab{% if active_banking_tab == 'settings' %} is-active{% endif %}"
          {% if active_banking_tab == 'settings' %}aria-current="page"{% endif %}
        >
          Banking Settings
        </a>
      </nav>
    </section>

    <section class="banking-overview">
      <header class="banking-overview__header">
        <h1>{{ bank_settings.bank_name }}</h1>
        <p>Monitor balances and account activity across every banking channel.</p>
      </header>
      <section class="account-activity" aria-label="Account activity">
        <header class="account-activity__header">
          <h2>Account Activity</h2>
        </header>
        <div class="account-activity__grid">
          <div class="account-activity__transactions" aria-label="Recent transactions">
            <h3>Recent transactions</h3>
            <p class="account-activity__description">
              The ledger captures deposits and withdrawals the moment they are submitted.
            </p>
            {% if recent_transactions %}
              <ul class="transaction-list">
                {% for transaction in recent_transactions %}
                  <li class="transaction-list__item" data-direction="{{ transaction.direction }}">
                    <div class="transaction-list__row">
                      <span class="transaction-list__name">{{ transaction.name }}</span>
                      <span class="transaction-list__amount">{{ transaction.amount_display }}</span>
                    </div>
                    <p class="transaction-list__meta">{{ transaction.account_name }} Â· {{ transaction.timestamp }}</p>
                    <p class="transaction-list__description">{{ transaction.description }}</p>
                  </li>
                {% endfor %}
              </ul>
              {% if has_more_transactions %}
                <span
                  class="transaction-view-more"
                  role="link"
                  tabindex="0"
                  data-view-more="{{ url_for('banking.transactions') }}"
                >
                  View more
                </span>
              {% endif %}
            {% else %}
              <p class="transaction-list__empty">
                No transactions recorded yet. Transfers will appear here automatically.
              </p>
            {% endif %}
          </div>
          <div class="account-activity__balances" aria-label="Account balances">
            <h3>Account balances</h3>
            <p class="account-activity__description">Track the latest totals for each account.</p>
            {% if not has_open_accounts %}
              <p class="account-activity__empty">
                No banking accounts are open yet. Use the Open Account action on the home page to get started.
              </p>
            {% endif %}
            <div class="account-grid">
              {% for account in accounts %}
                <article class="account-card" data-account-card data-account="{{ account.id }}">
                  <header>
                    {% if account.type %}
                      <p class="account-card__type">{{ account.type }}</p>
                    {% endif %}
                    <h2>{{ account.name }}</h2>
                  </header>
                  <p class="account-card__balance">
                    <span data-balance-value>{{ account.display_balance }}</span>
                  </p>
                </article>
              {% endfor %}
            </div>
            <section class="account-due" aria-label="Account due summary">
              <h4>Account Due</h4>
              <div class="account-due__grid">
                {% for due in account_due_cards %}
                  <article class="account-due__card">
                    <header>
                      <h5>{{ due.name }}</h5>
                      <span class="account-due__label">Amount Due</span>
                    </header>
                    <p class="account-due__amount">{{ due.amount }}</p>
                    <p class="account-due__note">{{ due.due_date }}</p>
                  </article>
                {% endfor %}
              </div>
            </section>
          </div>
        </div>
      </section>
    </section>
  </div>
{% endblock %}
